# MCTS_DUAL training config (YAML-only)
# Available scenarios:
# cross_2lane, cross_3lane, highway_2lane, highway_4lane 
# roundabout_2lane, roundabout_3lane, onrampmerge_3lane, bottleneck
env:
  num_agents: 3
  scenario_name: "onrampmerge_3lane" 
  max_steps: 500
  respawn_enabled: true

mcts:
  # Speed/quality presets (rough guide; depends on CPU/core count and scenario):
  #
  # 1) Fast debug (~2-5s/episode @ 500 steps):
  #    simulations: 20
  #    rollout_depth: 10
  #    num_action_samples: 8
  #
  # 2) Balanced (~2-5s/episode @ 500 steps):
  #    simulations: 50
  #    rollout_depth: 15
  #    num_action_samples: 8
  #
  # 3) Quality (current; ~30-40s/episode @ 500 steps on your machine):
  #    simulations: 100
  #    rollout_depth: 25
  #    num_action_samples: 16
  #
  # Note: runtime is roughly linear in simulations and num_action_samples, and also
  # increases with rollout_depth and num_agents.
  simulations: 100
  rollout_depth: 25
  num_action_samples: 16
  parallel: true
  max_workers: 4
  dirichlet_alpha: 0.3    # Dirichlet noise parameter for exploration
  dirichlet_eps: 0.25    # exploration noise
  dirichlet_decay_episodes: 2000 # Decay episodes for exploration
  min_dirichlet_eps: 0.03    # Minimum exploration noise

net:
  device: cpu          # auto/cpu/cuda
  use_tcn: true
  use_lstm: false
  sequence_length: 5

train:
  max_episodes: 100000
  save_frequency: 100
  loss_log_interval: 100
  save_dir: "MCTS_AlphaZero/checkpoints"
  load_checkpoint: ""  # empty means no load
  seed: 42
  deterministic: false
  use_shm: true
  c_pi: 1.0  # Policy loss weight
  c_v: 1.0  # Value loss weight
  returns_ema_beta: 0.99
  learning_rate: 1e-3
  update_every: 128
  mcts_debug:
    enabled: false      
    interval: 500      

render:
  enabled: false

reward:
  use_team_reward: true

misc:
  tqdm: false
